

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Detailed Look at the SceneWalk Code in Python &mdash; SceneWalk  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom_style.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The SceneWalk Model Object" href="../sw_core.html" />
    <link rel="prev" title="Using the SceneWalk Model" href="how_to_sw.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/sw_logo2.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Using the SceneWalk Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_requirements.html">Data Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_sw.html">Using the SceneWalk Model</a></li>
</ul>
<p class="caption"><span class="caption-text">Core Model Code</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Detailed Look at the SceneWalk Code in Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Empirical-Fixation-density-Map">Empirical Fixation density Map</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Model">Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Unpack-scenewalk-code">Unpack scenewalk code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sw_core.html">The SceneWalk Model Object</a></li>
</ul>
<p class="caption"><span class="caption-text">Evaluation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sw_evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_evaluation.html#module-scenewalk.evaluation.evaluate_sw_parallel">Full Estimation Doc</a></li>
</ul>
<p class="caption"><span class="caption-text">Estimation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sw_estimation.html">Estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_estimation.html#example-estimation-script">Example Estimation Script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_estimation.html#module-scenewalk.estimation.DREAM_param_estimation">Full Estimation Doc</a></li>
</ul>
<p class="caption"><span class="caption-text">Simulation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sw_simulation.html">Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_simulation.html#example-simulation">Example Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_simulation.html#module-scenewalk.simulation.simulate_dataset">Full Simulation Doc</a></li>
</ul>
<p class="caption"><span class="caption-text">Plotting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sw_plotting.html">Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_plotting.html#example-dynamic-visualization">Example: Dynamic Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_plotting.html#module-scenewalk.plotting.sw_plot">Full Plotting Doc</a></li>
</ul>
<p class="caption"><span class="caption-text">Utils</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sw_utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_utils.html#loaddata">loadData</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_utils.html#id1">utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sw_utils.html#resort">resort</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SceneWalk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Detailed Look at the SceneWalk Code in Python</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/demo/detailed_look_at_sw.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Detailed-Look-at-the-SceneWalk-Code-in-Python">
<h1>Detailed Look at the SceneWalk Code in Python<a class="headerlink" href="#Detailed-Look-at-the-SceneWalk-Code-in-Python" title="Permalink to this headline">¶</a></h1>
<p>This is a basic expanation of the original (subtractive scenewalk model) ## Load libraries and data The data we are using here is from the Memory3 experiment. We import it from a csv using pandas.</p>
<p>It may be interesting to note that the data is such that the bottom left hand corner is the axis origin.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">scenewalk.scenewalk_model_object</span> <span class="k">import</span> <span class="n">scenewalk</span> <span class="k">as</span> <span class="n">scenewalk_model</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scenewalk.plotting.sw_plot</span> <span class="k">import</span> <span class="n">plot_3_maps</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Load Data</span>
<span class="n">SAC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../../SceneWalk_research/DATA/Mem3/SAC_mem3.csv&#39;</span><span class="p">)</span>
<span class="n">SAC</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Start</th>
      <th>End</th>
      <th>PeakVel</th>
      <th>Ampl</th>
      <th>sacLen</th>
      <th>VP</th>
      <th>trial</th>
      <th>Img</th>
      <th>mode</th>
      <th>...</th>
      <th>fixdur</th>
      <th>blinkSac</th>
      <th>blinkFix</th>
      <th>viewnr</th>
      <th>dtc</th>
      <th>imtype2</th>
      <th>conformity</th>
      <th>gazepathLen</th>
      <th>conformityNorm</th>
      <th>conformityHans</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1</td>
      <td>1</td>
      <td>86</td>
      <td>1</td>
      <td>...</td>
      <td>98</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>0.254938</td>
      <td>1</td>
      <td>0.001490</td>
      <td>23</td>
      <td>-13.914239</td>
      <td>-9.390677</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>99.0</td>
      <td>109.0</td>
      <td>204.060792</td>
      <td>1.493026</td>
      <td>1.492857</td>
      <td>1</td>
      <td>1</td>
      <td>86</td>
      <td>1</td>
      <td>...</td>
      <td>630</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>1.744902</td>
      <td>1</td>
      <td>0.002793</td>
      <td>23</td>
      <td>-13.007765</td>
      <td>-8.484203</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>739.0</td>
      <td>781.0</td>
      <td>381.255743</td>
      <td>7.085431</td>
      <td>5.909781</td>
      <td>1</td>
      <td>1</td>
      <td>86</td>
      <td>1</td>
      <td>...</td>
      <td>228</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>8.408326</td>
      <td>1</td>
      <td>0.001407</td>
      <td>23</td>
      <td>-13.996878</td>
      <td>-9.473316</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1009.0</td>
      <td>1065.0</td>
      <td>406.522941</td>
      <td>9.542654</td>
      <td>8.586285</td>
      <td>1</td>
      <td>1</td>
      <td>86</td>
      <td>1</td>
      <td>...</td>
      <td>265</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>12.847886</td>
      <td>1</td>
      <td>0.000376</td>
      <td>23</td>
      <td>-15.901115</td>
      <td>-11.377553</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1330.0</td>
      <td>1362.0</td>
      <td>481.183495</td>
      <td>5.460476</td>
      <td>3.963403</td>
      <td>1</td>
      <td>1</td>
      <td>86</td>
      <td>1</td>
      <td>...</td>
      <td>183</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>16.963105</td>
      <td>1</td>
      <td>0.000257</td>
      <td>23</td>
      <td>-16.449903</td>
      <td>-11.926341</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>224314</th>
      <td>224315</td>
      <td>7963.0</td>
      <td>7974.0</td>
      <td>288.413440</td>
      <td>2.362354</td>
      <td>2.362354</td>
      <td>30</td>
      <td>80</td>
      <td>303</td>
      <td>3</td>
      <td>...</td>
      <td>405</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>5.811551</td>
      <td>4</td>
      <td>0.000953</td>
      <td>34</td>
      <td>-15.122182</td>
      <td>-10.034719</td>
    </tr>
    <tr>
      <th>224315</th>
      <td>224316</td>
      <td>8714.0</td>
      <td>8727.0</td>
      <td>292.242848</td>
      <td>2.884906</td>
      <td>2.882165</td>
      <td>30</td>
      <td>80</td>
      <td>303</td>
      <td>3</td>
      <td>...</td>
      <td>381</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>5.831994</td>
      <td>4</td>
      <td>0.000787</td>
      <td>34</td>
      <td>-15.399512</td>
      <td>-10.312049</td>
    </tr>
    <tr>
      <th>224316</th>
      <td>224317</td>
      <td>9108.0</td>
      <td>9139.0</td>
      <td>455.156418</td>
      <td>5.037857</td>
      <td>4.807370</td>
      <td>30</td>
      <td>80</td>
      <td>303</td>
      <td>3</td>
      <td>...</td>
      <td>255</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>8.625651</td>
      <td>4</td>
      <td>0.000037</td>
      <td>34</td>
      <td>-19.824252</td>
      <td>-14.736790</td>
    </tr>
    <tr>
      <th>224317</th>
      <td>224318</td>
      <td>9394.0</td>
      <td>9426.0</td>
      <td>317.557028</td>
      <td>5.585248</td>
      <td>5.585248</td>
      <td>30</td>
      <td>80</td>
      <td>303</td>
      <td>3</td>
      <td>...</td>
      <td>378</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>13.697656</td>
      <td>4</td>
      <td>0.000476</td>
      <td>34</td>
      <td>-16.125454</td>
      <td>-11.037991</td>
    </tr>
    <tr>
      <th>224318</th>
      <td>224319</td>
      <td>9804.0</td>
      <td>9839.0</td>
      <td>423.712189</td>
      <td>5.753254</td>
      <td>5.666740</td>
      <td>30</td>
      <td>80</td>
      <td>303</td>
      <td>3</td>
      <td>...</td>
      <td>169</td>
      <td>False</td>
      <td>False</td>
      <td>1</td>
      <td>17.375090</td>
      <td>4</td>
      <td>0.000003</td>
      <td>34</td>
      <td>-23.234150</td>
      <td>-18.146688</td>
    </tr>
  </tbody>
</table>
<p>224319 rows × 28 columns</p>
</div></div>
</div>
<p>From the data frame we extract the relevant data:</p>
<ul class="simple">
<li><p>positions of all fixations in the image for the emprirical saliency map.</p></li>
<li><p>positions and fixation durations of the gaze path we are analyzing.</p></li>
</ul>
<p>Both of these should be numpy arrays (not pandas) to stay consistent with indexing etc. (pandas is 1 indexed, normal python is 0 indexed).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">use_img</span> <span class="o">=</span> <span class="mi">35</span>

<span class="n">img_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SAC</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;Img&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_img</span><span class="p">])</span>
<span class="n">img_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SAC</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;Img&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_img</span><span class="p">])</span>

<span class="n">use_vp</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SAC</span><span class="o">.</span><span class="n">VP</span><span class="p">[</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;Img&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_img</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">use_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SAC</span><span class="o">.</span><span class="n">trial</span><span class="p">[</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;Img&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_img</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">path_x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SAC</span><span class="o">.</span><span class="n">x</span><span class="p">[(</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;Img&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_img</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;VP&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_vp</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;trial&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_trial</span><span class="p">)])</span>
<span class="n">path_y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SAC</span><span class="o">.</span><span class="n">y</span><span class="p">[(</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;Img&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_img</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;VP&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_vp</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;trial&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_trial</span><span class="p">)])</span>
<span class="n">path_dur</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SAC</span><span class="o">.</span><span class="n">fixdur</span><span class="p">[(</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;Img&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_img</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;VP&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_vp</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">SAC</span><span class="p">[</span><span class="s1">&#39;trial&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">use_trial</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<p>Let’s look at the data we imported. Each blue point is a fixation. Each red point is part of the scan path we’re going to analyze.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">im</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">img_x</span><span class="p">,</span> <span class="n">img_y</span><span class="p">)</span>
<span class="n">im</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">path_x</span><span class="p">,</span> <span class="n">path_y</span><span class="p">,</span> <span class="s1">&#39;.r-&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_6_0.png" src="../_images/demo_detailed_look_at_sw_6_0.png" />
</div>
</div>
<div class="section" id="Empirical-Fixation-density-Map">
<h2>Empirical Fixation density Map<a class="headerlink" href="#Empirical-Fixation-density-Map" title="Permalink to this headline">¶</a></h2>
<p>Normally the fixation desity that is used comes with the data set (see spatstat or corpus data). For historical reasons, they are computed in R.</p>
<p><code class="docutils literal notranslate"><span class="pre">sw.empirical_fixation_density()</span></code> makes a desity map that is very similar to the R version. It also converts the data to px.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d_range</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;x&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">0.00000</span><span class="p">,</span> <span class="mf">39.90938</span><span class="p">),</span>
    <span class="s2">&quot;y&quot;</span> <span class="p">:</span> <span class="p">(</span><span class="mf">0.00000</span><span class="p">,</span>  <span class="mf">26.60625</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">sw</span> <span class="o">=</span> <span class="n">scenewalk_model</span><span class="p">(</span><span class="s2">&quot;subtractive&quot;</span><span class="p">,</span> <span class="s2">&quot;zero&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="n">d_range</span><span class="p">)</span>
<span class="n">img_x_t</span><span class="p">,</span> <span class="n">img_y_t</span><span class="p">,</span> <span class="n">fix_dens</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">empirical_fixation_density</span><span class="p">(</span><span class="n">img_x</span><span class="p">,</span> <span class="n">img_y</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">img_x_t</span><span class="p">,</span> <span class="n">img_y_t</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">fix_dens</span><span class="p">),</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_8_0.png" src="../_images/demo_detailed_look_at_sw_8_0.png" />
</div>
</div>
</div>
<div class="section" id="Model">
<h2>Model<a class="headerlink" href="#Model" title="Permalink to this headline">¶</a></h2>
<p>For example we can use Heiko’s estimated parameters (sigmas times 4 because this model uses pixels and not degrees). Heiko had 2 parameters that were unreasonable. I’ve swapped them out here for demonstration purposes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">omegaAttention</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1">#2.4*(10^30)</span>
<span class="n">omegaInhib</span> <span class="o">=</span> <span class="mf">1.97</span>
<span class="n">sigmaAttention</span> <span class="o">=</span> <span class="mf">5.9</span>
<span class="n">sigmaInhib</span> <span class="o">=</span> <span class="mf">4.5</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mi">1</span><span class="c1">#44.780</span>
<span class="n">lamb</span> <span class="o">=</span> <span class="mf">0.8115</span>
<span class="n">inhibStrength</span> <span class="o">=</span> <span class="mf">0.3637</span>
<span class="n">zeta</span> <span class="o">=</span> <span class="mf">0.0722</span>

<span class="n">sw_params</span><span class="o">=</span><span class="p">[</span><span class="n">omegaAttention</span><span class="p">,</span> <span class="n">omegaInhib</span><span class="p">,</span> <span class="n">sigmaAttention</span><span class="p">,</span> <span class="n">sigmaInhib</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">lamb</span><span class="p">,</span> <span class="n">inhibStrength</span><span class="p">,</span> <span class="n">zeta</span><span class="p">]</span>

<span class="n">path_durR</span> <span class="o">=</span> <span class="n">path_dur</span><span class="o">/</span><span class="mi">1000</span>
</pre></div>
</div>
</div>
<p>Already previously we initiated a scenewalk model with the following command. To get into it more: the arguments are - subtractive: the way inhibition is added - zero: the initiation map is zero everywhere - off: no attention shifts - off: no occulomotor potential - off: no location dependent decay (i.e. facilitation of return is off) - data range</p>
<p>This is the configuration of the original scenewalk model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sw</span> <span class="o">=</span> <span class="n">scenewalk_model</span><span class="p">(</span><span class="s2">&quot;subtractive&quot;</span><span class="p">,</span> <span class="s2">&quot;zero&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="n">d_range</span><span class="p">)</span>
<span class="n">sw</span><span class="o">.</span><span class="n">update_params</span><span class="p">(</span><span class="n">sw_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we can get the likelihood of the scanpath.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path_x</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([20.13561279, 30.63710112, 23.16872571, 19.94138714, 32.54210889,
       32.8480808 , 31.62685376, 32.65119453, 36.71663009, 37.4722477 ,
       37.00929888, 37.69041898, 37.27004017, 38.73072349, 36.81108229,
       37.33921643, 37.04654764, 33.90967033, 25.34245664, 18.37161817,
       17.27277989, 20.69035318, 22.55412125, 25.43557853, 18.25189003])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sw</span><span class="o">.</span><span class="n">get_scanpath_likelihood</span><span class="p">(</span><span class="n">path_x</span><span class="p">,</span> <span class="n">path_y</span><span class="p">,</span> <span class="n">path_durR</span><span class="p">,</span> <span class="n">fix_dens</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-297.28024961378914465
</pre></div></div>
</div>
</div>
<div class="section" id="Unpack-scenewalk-code">
<h2>Unpack scenewalk code<a class="headerlink" href="#Unpack-scenewalk-code" title="Permalink to this headline">¶</a></h2>
<p>Here we step through what happens in the model when we call <code class="docutils literal notranslate"><span class="pre">get_scanpath_likelihood</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sw</span> <span class="o">=</span> <span class="n">scenewalk_model</span><span class="p">(</span><span class="s2">&quot;subtractive&quot;</span><span class="p">,</span> <span class="s2">&quot;zero&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="s2">&quot;off&quot;</span><span class="p">,</span> <span class="n">d_range</span><span class="p">)</span>
<span class="n">sw</span><span class="o">.</span><span class="n">update_params</span><span class="p">(</span><span class="n">sw_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We will need to extract the individual fixations to step through the code</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fix_x</span> <span class="o">=</span> <span class="n">path_x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">fix_x</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">convert_deg_to_px</span><span class="p">(</span><span class="n">fix_x</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fix_y</span> <span class="o">=</span> <span class="n">path_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">fix_y</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">convert_deg_to_px</span><span class="p">(</span><span class="n">fix_y</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">fix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">duration</span> <span class="o">=</span> <span class="n">path_dur</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>This is the initial state of the model. The attention map is set to (almost) 0. The inhibition map is set to 1. We’ll keep working with the configuration described above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">prev_mapAtt</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">att_map_init</span><span class="p">()</span>
<span class="n">prev_mapInhib</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">initialize_map_unif</span><span class="p">()</span>

<span class="n">plot_3_maps</span><span class="p">(</span><span class="n">inhib_map</span><span class="o">=</span><span class="n">prev_mapInhib</span><span class="p">,</span> <span class="n">att_map</span><span class="o">=</span><span class="n">prev_mapAtt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_21_0.png" src="../_images/demo_detailed_look_at_sw_21_0.png" />
</div>
</div>
<p>Start with the first fixation: Gaussians around fixation position</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### equation 5</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float128</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">128</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">128</span><span class="p">])</span>
<span class="n">rad</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">xx</span> <span class="o">-</span> <span class="n">fix_x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">yy</span> <span class="o">-</span> <span class="n">fix_y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
<span class="n">gaussAttention</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">sigmaAttention</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">rad</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span> <span class="p">(</span><span class="n">sigmaAttention</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">gaussInhib</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">sigmaInhib</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">rad</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sigmaInhib</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">plot_3_maps</span><span class="p">(</span><span class="n">inhib_map</span><span class="o">=</span><span class="n">gaussInhib</span><span class="p">,</span> <span class="n">att_map</span><span class="o">=</span><span class="n">gaussAttention</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_23_0.png" src="../_images/demo_detailed_look_at_sw_23_0.png" />
</div>
</div>
<p>The Attention Gauss gets weighted by the empirical saliency. Then we add the exponent to develop the map over time.</p>
<p>The Inhibition Gauss also gets developed over time using the exponent.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### equation 8</span>
<span class="n">salFixation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">fix_dens</span><span class="p">,</span> <span class="n">gaussAttention</span><span class="p">)</span>
<span class="n">salFixation</span> <span class="o">=</span> <span class="n">salFixation</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">salFixation</span><span class="p">)</span>
<span class="n">mapAtt</span> <span class="o">=</span> <span class="n">salFixation</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">duration</span> <span class="o">*</span> <span class="n">omegaAttention</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">prev_mapAtt</span> <span class="o">-</span> <span class="n">salFixation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### equation 9</span>
<span class="n">gaussInhib</span> <span class="o">=</span> <span class="n">gaussInhib</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">gaussInhib</span><span class="p">)</span>
<span class="n">mapInhib</span> <span class="o">=</span> <span class="n">gaussInhib</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">duration</span> <span class="o">*</span> <span class="n">omegaInhib</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">prev_mapInhib</span> <span class="o">-</span> <span class="n">gaussInhib</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This is what it looks like after the temporal evolution</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plot_3_maps</span><span class="p">(</span><span class="n">inhib_map</span><span class="o">=</span><span class="n">mapInhib</span><span class="p">,</span> <span class="n">att_map</span><span class="o">=</span><span class="n">mapAtt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_28_0.png" src="../_images/demo_detailed_look_at_sw_28_0.png" />
</div>
</div>
<p>Next, both maps get weighted with an exponent (lambda or gamma). In then step numerical problems often occur, because taking a large exponent of a number between 0 and 1 can easily make the number so small, that it gets flushed to 0 by the computer.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### equation 10</span>
<span class="n">mapAttPower</span> <span class="o">=</span> <span class="n">mapAtt</span> <span class="o">**</span> <span class="n">lamb</span>
<span class="n">mapAttPowerNorm</span> <span class="o">=</span> <span class="n">mapAttPower</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mapAttPower</span><span class="p">)</span>
<span class="c1"># handle numerical problem 1</span>
<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mapAttPowerNorm</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
        <span class="s2">&quot;Value of *lambda* is too large. All of mapAttPower is flushed to zero.&quot;</span><span class="p">)</span>
    <span class="c1"># set to uniform?</span>

<span class="n">mapInhibPower</span> <span class="o">=</span> <span class="n">mapInhib</span> <span class="o">**</span> <span class="n">gamma</span>
<span class="n">mapInhibPowerNorm</span> <span class="o">=</span> <span class="n">mapInhibPower</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mapInhibPower</span><span class="p">)</span>
<span class="c1"># handle numerical problem 1</span>
<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mapInhibPowerNorm</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
        <span class="s2">&quot;Value of *gamma* is too large. All of mapInhibPower is flushed to zero.&quot;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mapAttPowerNorm</span> <span class="o">-</span> <span class="n">inhibStrength</span> <span class="o">*</span> <span class="n">mapInhibPowerNorm</span>     <span class="c1"># subtractive inhibition</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plot_3_maps</span><span class="p">(</span><span class="n">ufinal_map</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">inhib_map</span><span class="o">=</span><span class="n">mapInhibPowerNorm</span><span class="p">,</span> <span class="n">att_map</span><span class="o">=</span><span class="n">mapAttPowerNorm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_32_0.png" src="../_images/demo_detailed_look_at_sw_32_0.png" />
</div>
</div>
<p>In this state u can can have negative elements. Those are now flushed to 0.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### equation 12</span>
<span class="n">ustar</span> <span class="o">=</span> <span class="n">u</span>
<span class="n">ustar</span><span class="p">[</span><span class="n">ustar</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># Heiko handles case where sum(ustar)=0 by if else (path3)</span>
<span class="n">plot_3_maps</span><span class="p">(</span><span class="n">ufinal_map</span><span class="o">=</span><span class="n">ustar</span><span class="p">,</span> <span class="n">inhib_map</span><span class="o">=</span><span class="n">mapInhibPowerNorm</span><span class="p">,</span> <span class="n">att_map</span><span class="o">=</span><span class="n">mapAttPowerNorm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_34_0.png" src="../_images/demo_detailed_look_at_sw_34_0.png" />
</div>
</div>
<p>Lastly some noise is added through the zeta parameter</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">### equation 13</span>
<span class="n">uFinal</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">zeta</span><span class="p">)</span> <span class="o">*</span> <span class="n">ustar</span> <span class="o">+</span> <span class="n">zeta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plot_3_maps</span><span class="p">(</span><span class="n">ufinal_map</span><span class="o">=</span><span class="n">uFinal</span><span class="p">,</span> <span class="n">inhib_map</span><span class="o">=</span><span class="n">mapInhib</span><span class="p">,</span> <span class="n">att_map</span><span class="o">=</span><span class="n">mapAtt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_37_0.png" src="../_images/demo_detailed_look_at_sw_37_0.png" />
</div>
</div>
<p>This is the map after the first fixation. We can now continue evolving the map using the above procedure. Instead of passing in the initialization maps, we pass in the evolved maps (the version before the exponent and the noise are added).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sw.evolve_maps</span></code> function takes the steps explicitely shown above to yield the three maps.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">uFinal2</span><span class="p">,</span> <span class="n">mapInhib2</span><span class="p">,</span> <span class="n">mapAtt2</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">evolve_maps</span><span class="p">(</span><span class="n">path_durR</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span>                                                          <span class="n">path_x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span>
                                                   <span class="n">path_y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span>
                                                   <span class="n">mapAtt</span><span class="p">,</span> <span class="n">mapInhib</span><span class="p">,</span>
                                                   <span class="n">fix_dens</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plot_3_maps</span><span class="p">(</span><span class="n">ufinal_map</span><span class="o">=</span><span class="n">uFinal2</span><span class="p">,</span> <span class="n">inhib_map</span><span class="o">=</span><span class="n">mapInhib2</span><span class="p">,</span> <span class="n">att_map</span><span class="o">=</span><span class="n">mapAtt2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_39_0.png" src="../_images/demo_detailed_look_at_sw_39_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">uFinal3</span><span class="p">,</span> <span class="n">mapInhib3</span><span class="p">,</span> <span class="n">mapAtt3</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">evolve_maps</span><span class="p">(</span><span class="n">path_durR</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span>                                                          <span class="n">path_x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span>
                                                   <span class="n">path_y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span>
                                                   <span class="n">mapAtt2</span><span class="p">,</span> <span class="n">mapInhib2</span><span class="p">,</span>
                                                   <span class="n">fix_dens</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plot_3_maps</span><span class="p">(</span><span class="n">ufinal_map</span><span class="o">=</span><span class="n">uFinal3</span><span class="p">,</span> <span class="n">inhib_map</span><span class="o">=</span><span class="n">mapInhib3</span><span class="p">,</span> <span class="n">att_map</span><span class="o">=</span><span class="n">mapAtt3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/demo_detailed_look_at_sw_40_0.png" src="../_images/demo_detailed_look_at_sw_40_0.png" />
</div>
</div>
<p>etc…</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../sw_core.html" class="btn btn-neutral float-right" title="The SceneWalk Model Object" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="how_to_sw.html" class="btn btn-neutral float-left" title="Using the SceneWalk Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Lisa Schwetlick

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>